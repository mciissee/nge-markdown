# Contributions

The killer feature of **nge-markdown** is it's contribution API that let
you transform the HTML produced by the markdown parser.
The library comes also with a set of useful default contributions.

## Default contributions

There is a preconfigured Provider object for all of the default contributions,
you can directly add them to the `providers` array of your application main module and start using them.

The `NgeMarkdownHighlighterMonacoProvider` provider is a quite special, go to
[NgeMarkdownHighlighter](/contributions/nge-markdown-highlighter) page to learn more about it.

```typescript highlights="6-17 26-32 36-43"
import { HttpClientModule } from '@angular/common/http';
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { BrowserAnimationsModule } from '@angular/platform-browser/animations';

import { NgeMonacoModule, NgeMonacoColorizerService, NGE_THEMES } from 'nge-monaco';
import {
    NgeMarkdownModule,
    NgeMarkdownTabbedSetProvider,
    NgeMarkdownAdmonitionsProvider,
    NgeMarkdownLinkAnchorProvider,
    NgeMarkdownKatexProvider,
    NgeMarkdownEmojiProvider,
    NgeMarkdownIconsProvider,
    NgeMarkdownHighlighterProvider,
    NgeMarkdownHighlighterMonacoProvider,
} from 'nge-markdown';

import { AppComponent } from './app.component';

@NgModule({
    declarations: [AppComponent],
    imports: [
        BrowserModule,
        HttpClientModule,
        NgeMarkdownModule,
        NgeMonacoModule.forRoot({
            theming: {
                themes: NGE_THEMES.map(theme => 'assets/themes/' + theme),
                default: 'github'
            }
        }),
        BrowserAnimationsModule,
    ],
    providers: [
        NgeMarkdownKatexProvider,
        NgeMarkdownIconsProvider,
        NgeMarkdownEmojiProvider,
        NgeMarkdownTabbedSetProvider,
        NgeMarkdownLinkAnchorProvider,
        NgeMarkdownAdmonitionsProvider,
        NgeMarkdownHighlighterProvider,
        NgeMarkdownHighlighterMonacoProvider(NgeMonacoColorizerService),
    ],
    bootstrap: [AppComponent],
})
export class AppModule {}
```

## Custom contributions

### NgeMarkdownContribution

A contribution in **nge-markdown** is a class that implements `NgeMarkdownContribution` interface and it's
`contribute` method.

This method is called with an object of type `NgeMarkdownTransformer` that expose methods allowing to register
a callback function to call during the different phases of the parsing.

* `addMarkdownTransformer` method can be used to register a function that will compute
 the original markdown string passed to the parser.

* `addRendererTransformer` method can be used to register a function that will compute the instance
  of marked [Renderer](https://marked.js.org/using_pro#renderer).

* `addTokenizerTransformer` method can be used to register a function that will compute the instance
  of marked [Tokenizer](https://marked.js.org/using_pro#tokenizer).

* `addAstTransformer` method can be used to register a function that will compute the tokens
  generated by marked [lexer](https://marked.js.org/using_pro#lexer).

* `addHtmlTransformer` method can be used to register a function that will compute the html generated
  by the marked [parser](https://marked.js.org/using_pro#parser).

## Example

=== my-contrib.ts

```typescript
import { Injectable, Provider } from '@angular/core';
import {
    NgeMarkdownTransformer,
    NgeMarkdownContribution,
    NGE_MARKDOWN_CONTRIBUTION,
} from 'nge-markdown';

@Injectable()
export class MyMarkdownContribution implements NgeMarkdownContribution {

    dependencies() {
      if ('katex' in window) {
        return [];
      }
      // add katex to document head if needed.
      // this ensure that katex is available inside the transform methods.
      return [
        ['style', 'https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css'],
        ['script', 'https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js'],
      ];
    }

    contribute(api: NgeMarkdownTransformer) {
        const args = api.contribArguments[MyMarkdownContributionArgsKey] || {} as MyMarkdownContributionArgs;
        console.log(args.myArg1);
  
        // call the methods of the api here
    }
}

export const MyMarkdownContributionProvider: Provider = {
    provide: NGE_MARKDOWN_CONTRIBUTION,
    multi: true,
    useClass: MyMarkdownContribution,
};
```

=== app.module.ts

```typescript
import { HttpClientModule } from '@angular/common/http';
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { BrowserAnimationsModule } from '@angular/platform-browser/animations';

import { NgeMarkdownModule } from 'nge-markdown';

import { MyMarkdownContributionProvider } from './my-contribution';
import { AppComponent } from './app.component';

@NgModule({
    declarations: [AppComponent],
    imports: [
        BrowserModule,
        HttpClientModule,
        NgeMarkdownModule,
        BrowserAnimationsModule,
    ],
    providers: [
        MyMarkdownContributionProvider
    ],
    bootstrap: [AppComponent],
})
export class AppModule {}
```

===
